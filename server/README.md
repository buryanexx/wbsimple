# WB Simple API

Масштабируемый REST API сервер для образовательной платформы WB Simple, предназначенной для продавцов Wildberries.

## Технологический стек

- Node.js (v18+)
- TypeScript
- Express.js
- PostgreSQL (с Prisma ORM)
- Redis (для кэширования и сессий)
- JWT (аутентификация)
- Docker и Docker Compose (контейнеризация)
- Nginx (в качестве прокси)

## Особенности архитектуры

- Использование современных практик разработки Node.js
- Масштабируемая архитектура с возможностью горизонтального масштабирования
- Эффективное кэширование для повышения производительности
- Контейнеризация для упрощения развертывания
- Интеграция с Telegram WebApp для аутентификации
- Полная поддержка TypeScript для типобезопасной разработки
- Структурированное логирование для отслеживания работы приложения

## Начало работы

### Предварительные требования

- Node.js v18 или выше
- Docker и Docker Compose (для контейнеризации)
- PostgreSQL (если разработка без Docker)
- Redis (если разработка без Docker)

### Установка

1. Клонируйте репозиторий:
```bash
git clone <url-репозитория>
cd wbsimple-api
```

2. Установите зависимости:
```bash
npm install
```

3. Создайте .env файл на основе .env.example:
```bash
cp .env.example .env
```

4. Настройте переменные окружения в .env файле:
```
# Минимально необходимые настройки
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/wbsimple
TELEGRAM_BOT_TOKEN=your_telegram_bot_token
JWT_SECRET=your_jwt_secret
```

### Запуск для разработки

```bash
# Генерация клиента Prisma
npx prisma generate

# Запуск миграций базы данных
npx prisma migrate dev

# Запуск сервера
npm run dev
```

### Запуск с использованием Docker

```bash
# Сборка и запуск всех сервисов
docker-compose up -d

# Или используйте скрипт деплоя
./deploy.sh
```

## Структура проекта

```
├── src/                # Исходный код
│   ├── config/         # Конфигурация приложения
│   ├── controllers/    # Контроллеры для обработки запросов
│   ├── middlewares/    # Middleware функции
│   ├── models/         # Модели данных и взаимодействие с БД
│   ├── routes/         # Маршруты API
│   ├── services/       # Бизнес-логика
│   ├── types/          # TypeScript типы
│   ├── utils/          # Вспомогательные функции
│   └── index.ts        # Точка входа в приложение
├── prisma/             # Схема Prisma и миграции
├── dist/               # Скомпилированный JavaScript (в .gitignore)
├── logs/               # Логи приложения (в .gitignore)
├── node_modules/       # Зависимости (в .gitignore)
├── docker-compose.yml  # Конфигурация Docker Compose
├── Dockerfile          # Инструкции для сборки Docker образа
├── .env.example        # Пример файла окружения
├── .env                # Переменные окружения (в .gitignore)
├── package.json        # Зависимости и скрипты
├── tsconfig.json       # Конфигурация TypeScript
└── README.md           # Документация проекта
```

## API Endpoints

### Аутентификация

- `POST /api/auth/telegram` - Аутентификация через Telegram WebApp
- `GET /api/auth/me` - Получение информации о текущем пользователе
- `POST /api/auth/progress` - Обновление прогресса пользователя

### Будущие эндпоинты

- `GET /api/modules` - Получение списка модулей
- `GET /api/modules/:id` - Получение информации о модуле
- `GET /api/lessons/:id` - Получение информации об уроке
- `POST /api/feedback` - Отправка обратной связи

## Разработка

### Добавление новых контроллеров

1. Создайте новый файл в директории `src/controllers/`
2. Определите классовый контроллер с необходимыми методами
3. Создайте соответствующие типы в `src/types/`
4. Создайте маршруты в `src/routes/`
5. Добавьте маршруты в `src/routes/index.ts`

### Запуск тестов

```bash
npm run test
```

## Развертывание

### Деплой на сервер

1. Убедитесь, что Docker и Docker Compose установлены на сервере
2. Скопируйте проект на сервер
3. Создайте и настройте .env.production
4. Запустите скрипт деплоя:

```bash
./deploy.sh
```

## Лицензия

Этот проект является приватным и предназначен только для использования в рамках компании.

## Авторы

- Команда WB Simple 